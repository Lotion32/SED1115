def inverse_kinematics_norm(x_norm, y_norm):
    """
    x_norm, y_norm in [0,1]:
      x_norm = 0 → right edge,  x_norm = 1 → left edge
      y_norm = 0 → top edge,    y_norm = 1 → bottom edge

    Returns: (shoulder_servo_angle_deg, elbow_servo_angle_deg)
    """

    # Map normalized to paper mm 
    cx = (1.0 - x_norm) * PAPER_WIDTH # sees 0 as all the way to the right edge and 1 as all the way to the left edge 
    cy = (1.0 - y_norm) * PAPER_HEIGHT # sees 0 as all the way up and 1 as all the way down 

    dx = cx - SHOULDER_X #Both A and C is the pen tip postion 
    dy = cy - SHOULDER_Y 

    # Distance AC
    lac = math.sqrt(dx*dx + dy*dy)
    max_reach = L1 + L2

    if lac == 0 or lac > max_reach:
        raise ValueError("Outside bounds (unreachable)")

    # Law of cosines for elbow
    cos_t2 = (dx*dx + dy*dy - L1*L1 - L2*L2) / (2.0 * L1 * L2)
    cos_t2 = min(1,max(-1,cos_t2)) 

    sin_t2 = math.sqrt(max(0.0, 1.0 - cos_t2*cos_t2))
    theta2 = math.atan2(sin_t2, cos_t2)

    # Shoulder angle( 
    k1 = L1 + L2 * cos_t2 # the vector thats parellel with L1 on a local level
    k2 = L2 * sin_t2 # the vector thats perpendicular to L1 on a local level 
    theta1 = math.atan2(dy, dx) - math.atan2(k2, k1) # the dirrectional angle of lac relative to the x axis - the bend of the internal angle  

    # Joint angles in degrees
    shoulder_deg = math.degrees(theta1)
    elbow_deg    = math.degrees(theta2)
    print("  [IK] elbow_deg = {:.1f}".format(elbow_deg))

    # Map to servo "horn" angles using calibration
    shoulder_servo = SHOULDER_A * shoulder_deg + SHOULDER_B
    elbow_servo    = ELBOW_A    * elbow_deg    + ELBOW_B

    

    return shoulder_servo, elbow_servo




# Pots:
# ADC(1) → GP27, ADC(0) → GP26 on Pico.
# If your board wired differently, swap these.
pot_x = ADC(1)   # left knob  → x_norm
pot_y = ADC(0)   # right knob → y_norm

# Servos on GP0 (shoulder) and GP1 (elbow)
servo_shoulder = PWM(Pin(0))
servo_elbow    = PWM(Pin(1))
servo_shoulder.freq(50)
servo_elbow.freq(50)

print("Normalized IK robot ready – pots → [0,1] → IK → servos")


while True:
    # 1) Read pots (0–65535) and normalize to [0,1]
    raw_x = pot_x.read_u16()
    raw_y = pot_y.read_u16()

    x_norm = raw_x / 65535.0
    y_norm = raw_y / 65535.0
